var TrNgGrid;(function(){var n="trNgGrid",u="tr-ng-grid-header",i="tr-ng-grid-body",f="tr-ng-grid-footer",e="tr-ng-grid-global-filter",o="tr-ng-grid-pager",t="tr-ng-grid-column",s="tr-ng-grid-column-sort",h="tr-ng-grid-column-filter",c="tr-ng-grid-row-page-item-index",l="tr-ng-grid table table-bordered table-hover",r="tr-ng-cell",a="",v="tr-ng-title",y="tr-ng-sort",p="tr-ng-column-filter",w="",b="tr-ng-sort-active",k="tr-ng-sort-inactive",d="tr-ng-sort-reverse",g="active",nt="tr-ng-grid-footer form-inline",tt=function(){function n(n,t,i,r,u,f,e){var o=this,s;this.$compile=n;this.$parse=f;this.$timeout=e;this.gridElement=i;this.internalScope=t;this.scheduledRecompilationDereg=null;s="gridOptions";this.gridOptions={items:[],selectedItems:[],filterBy:null,filterByFields:{},orderBy:null,orderByReverse:!1,pageItems:null,currentPage:0,totalItems:null,enableFiltering:!0,enableSorting:!0,enableSelections:!0,enableMultiRowSelections:!0,onDataRequiredDelay:1e3};this.gridOptions.onDataRequired=r.onDataRequired?t.onDataRequired:null;this.gridOptions.gridColumnDefs=[];t[s]=this.gridOptions;this.externalScope=this.internalScope.$parent;this.linkScope(this.internalScope,s,r);this.gridOptions.onDataRequired&&t.$watchCollection("[gridOptions.filterBy, gridOptions.filterByFields, gridOptions.orderBy, gridOptions.orderByReverse, gridOptions.currentPage]",function(){o.dataRequestPromise&&(o.$timeout.cancel(o.dataRequestPromise),o.dataRequestPromise=null);o.dataRequestPromise=o.$timeout(function(){o.dataRequestPromise=null;o.gridOptions.onDataRequired(o.gridOptions)},o.gridOptions.onDataRequiredDelay,!0)});this.internalScope.$watch("enableMultiRowSelections",function(n,t){n===t||n||o.gridOptions.selectedItems.length>1&&o.gridOptions.selectedItems.splice(1)});this.internalScope.$watch("enableSelections",function(n,t){n===t||n||(o.gridOptions.selectedItems.splice(0),o.gridOptions.enableMultiRowSelections=!1)})}return n.prototype.setColumnOptions=function(n,t){n>=this.gridOptions.gridColumnDefs.length?(this.gridOptions.gridColumnDefs.push({}),this.setColumnOptions(n,t)):this.gridOptions.gridColumnDefs[n]=t},n.prototype.toggleSorting=function(n){this.gridOptions.orderBy!=n?this.gridOptions.orderBy=n:this.gridOptions.orderByReverse=!this.gridOptions.orderByReverse},n.prototype.setFilter=function(n,t){t?this.gridOptions.filterByFields[n]=t:delete this.gridOptions.filterByFields[n];this.gridOptions.filterByFields=$.extend({},this.gridOptions.filterByFields)},n.prototype.toggleItemSelection=function(n){if(this.gridOptions.enableSelections){var t=this.gridOptions.selectedItems.indexOf(n);t>=0?this.gridOptions.selectedItems.splice(t,1):(this.gridOptions.enableMultiRowSelections||this.gridOptions.selectedItems.splice(0),this.gridOptions.selectedItems.push(n))}},n.prototype.scheduleRecompilationOnAvailableItems=function(){var n=this;this.scheduledRecompilationDereg||this.gridOptions.items&&this.gridOptions.items.length||(this.scheduledRecompilationDereg=this.internalScope.$watch("items.length",function(t){t>0&&(n.scheduledRecompilationDereg(),n.$compile(n.gridElement)(n.externalScope))}))},n.prototype.linkScope=function(n,t,i){var u=n[t],r,e,o,f,s;for(r in u)e=typeof i[r]!="undefined"&&i[r]!=null,e&&(o=!1,typeof n[r]!="undefined"&&n[r]!=null&&(u[r]=n[r],o=u[r]instanceof Array),f=this.$parse(i[r]),s=f&&f.assign,s&&function(i){n.$watch(t+"."+i,function(t,r){t!==r&&(n[i]=u[i])});n.$watch(i,function(t,r){t!==r&&(u[i]=n[i])})}(r))},n.prototype.splitByCamelCasing=function(n){var t=n.split(/(?=[A-Z])/);return t.length&&t[0].length&&(t[0]=t[0][0].toLocaleUpperCase()+t[0].substr(1)),t.join(" ")},n}();angular.module("trNgGrid",[]).directive(n,[function(){return{restrict:"A",scope:{items:"=",selectedItems:"=?",filterBy:"=?",filterByFields:"=?",orderBy:"=?",orderByReverse:"=?",pageItems:"=?",currentPage:"=?",totalItems:"=?",enableFiltering:"=?",enableSorting:"=?",enableSelections:"=?",enableMultiRowSelections:"=?",onDataRequired:"&",onDataRequiredDelay:"=?"},controller:["$compile","$scope","$element","$attrs","$transclude","$parse","$timeout",tt],compile:function(n){var s,r,c,e,h,y,p;n.addClass(l);var a=!1,v=!1,o=n.children("thead");o.length==0&&(o=$("<thead>"),v=!0);s=o.children("tr");s.length==0&&(s=$("<tr>").appendTo(o));s.attr(u,"");s.children("th[field-name]").attr(t,"");r=n.children("tbody");r.length===0&&(r=$("<tbody>").appendTo(n));c=r.children("tr");c.length===0&&(c=$("<tr>").appendTo(r));r.attr(i,"");e=n.children("tfoot");e.length==0&&(e=$("<tfoot>"),a=!0);h=e.children("tr");h.length==0&&(h=$("<tr>").appendTo(e));h.children("td").length==0&&(y=$("<td>").attr("colspan","999").appendTo(h),p=$("<div>").attr(f,"").appendTo(y));v&&n.prepend(o);a&&e.insertBefore(r)}}}]).directive("trNgGridHeader",["$compile",function(i){return{restrict:"A",scope:!1,require:"^"+n,compile:function(){return{pre:function(n,r,u,f){var e,s,o,h;if(r.children("th").length==0)if(f.gridOptions.items&&f.gridOptions.items.length>0){e=[];for(s in f.gridOptions.items[0])s.match(/^[_\$]/g)||e.push(s);for(o=0;o<e.length;o++)h=$("<th>").attr(t,"").attr("field-name",e[o]).appendTo(r),i(h)(n)}else f.scheduleRecompilationOnAvailableItems()}}}}}]).directive("trNgGridColumn",["$compile",function(i){return{restrict:"A",scope:!0,require:"^"+n,compile:function(){var n;return{pre:function(i,r,u,f){var o=r.prop("tagName")=="TH",e;if(!o)throw"The template has an invalid header column template element. Column templates must be defined on TH elements inside THEAD/TR";(n=r.parent().children("th").index(r),n<0)||(i.gridOptions=f.gridOptions,i.toggleSorting=function(n){return f.toggleSorting(n)},i.filter="",i.$watch("filter",function(n,t){n!==t&&f.setFilter(i.currentGridColumnDef.fieldName,n)}),e=function(){i.currentGridColumnDef.fieldName=u.fieldName;i.currentGridColumnDef.displayName=typeof u.displayName=="undefined"?f.splitByCamelCasing(u.fieldName):u.displayName;i.currentGridColumnDef.enableFiltering=u.enableFiltering=="true"||typeof u.enableFiltering=="undefined"&&i.gridOptions.enableFiltering;i.currentGridColumnDef.enableSorting=u.enableSorting=="true"||typeof u.enableSorting=="undefined"&&i.gridOptions.enableSorting;i.currentGridColumnDef.displayAlign=u.displayAlign;i.currentGridColumnDef.displayFormat=u.displayFormat;i.currentGridColumnDef.cellWidth=u.cellWidth;i.currentGridColumnDef.cellHeight=u.cellHeight},i.currentGridColumnDef={},e(),i.$watchCollection("[gridOptions.enableFiltering,gridOptions.enableSorting]",function(){e()}),f.setColumnOptions(n,i.currentGridColumnDef),r.removeAttr(t))},post:function(n,t){if(n.currentGridColumnDef){if(!n.currentGridColumnDef.fieldName)throw"The column definition for trNgGrid must contain the field name";if(n.currentGridColumnDef.cellWidth&&t.css("width",n.currentGridColumnDef.cellWidth),n.currentGridColumnDef.cellHeight&&t.css("height",n.currentGridColumnDef.cellHeight),t.text()==""){var u=$("<div>").addClass(r),f=$("<div>").addClass(a).appendTo(u);$("<div>").addClass(v).text(n.currentGridColumnDef.displayName).appendTo(f);$("<div>").attr(s,"").appendTo(f);$("<div>").attr(h,"").appendTo(u);t.append(i(u)(n))}}}}}}}]).directive("trNgGridColumnSort",[function(){return{restrict:"A",replace:!0,template:function(){return"<div ng-show='currentGridColumnDef.enableSorting' ng-click='toggleSorting(currentGridColumnDef.fieldName)' title='Sort' class='"+y+"'><div ng-class=\"{'"+b+"':gridOptions.orderBy==currentGridColumnDef.fieldName,'"+k+"':gridOptions.orderBy!=currentGridColumnDef.fieldName,'"+d+"':gridOptions.orderByReverse}\"  ><\/div><\/div>"}}}]).directive("trNgGridColumnFilter",[function(){return{restrict:"A",replace:!0,template:function(){return"<div ng-show='currentGridColumnDef.enableFiltering' class='"+p+"'><div class='"+w+"'><input class='form-control input-sm' type='text' ng-model='filter'/><\/div><\/div>"},link:function(){}}}]).filter("paging",function(){return function(n,t){var i,r;return(n&&(t.totalItems=n.length),!t.pageItems||!n||n.length==0)?n:(t.currentPage||(t.currentPage=0),i=t.currentPage*t.pageItems,i>=n.length&&(t.currentPage=0,i=0),r=t.currentPage*t.pageItems+t.pageItems,n.slice(i,r))}}).directive("trNgGridBody",["$compile",function(u){return{restrict:"A",scope:!0,require:"^"+n,replace:!0,compile:function(n){var f=n.children("tr");return n.contents().remove(),{post:function(n,e,o,s){var l,h;n.gridOptions=s.gridOptions;n.toggleItemSelection=function(n){return s.toggleItemSelection(n)};l="gridItem in gridOptions.items";n.gridOptions.onDataRequired||(l+=" | filter:gridOptions.filterBy | filter:gridOptions.filterByFields | orderBy:gridOptions.orderBy:gridOptions.orderByReverse | paging:gridOptions");h=f.clone(!0);h.attr("ng-repeat",l);h.attr("ng-click")||h.attr("ng-click","toggleItemSelection(gridItem)");h.attr("ng-class","{'"+g+"':gridOptions.selectedItems.indexOf(gridItem)>=0}");h.attr(c,"{{$index}}");angular.forEach(n.gridOptions.gridColumnDefs,function(n,t){var i=h.children("td:nth-child("+(t+1)+")"),s=i.attr("field-name"),o=!1,e,u,f;s!==n.fieldName?(o=!0,e=$("<td>"),i.length==0?h.append(e):i.before(e),i=e):o=i.text()=="";o&&(u=$("<div>").addClass(r),n.fieldName?(u.attr("field-name",n.fieldName),f="{{gridItem."+n.fieldName,n.displayFormat&&(n.displayFormat[0]!="|"&&n.displayFormat[0]!="."&&(f+=" | "),f+=n.displayFormat),f+="}}",u.text(f)):u.text("Invalid column match inside the table body"),i.append(u));n.displayAlign&&i.addClass("text-"+n.displayAlign);n.cellWidth&&i.css("width",n.cellWidth);n.cellHeight&&i.css("height",n.cellHeight)});e.append(u(h)(n));e.removeAttr(i);e.children("td["+t+"]").removeAttr(t)}}}}}]).directive("trNgGridFooter",[function(){return{restrict:"A",scope:!1,require:"^"+n,replace:!0,template:'<div class="'+nt+'"><span '+e+'=""/><span '+o+'=""/><\/div>'}}]).directive("trNgGridGlobalFilter",[function(){return{restrict:"A",replace:!0,scope:!0,require:"^"+n,template:function(){return'<span ng-show="gridOptions.enableFiltering" class="pull-left form-group"><input class="form-control" type="text" ng-model="gridOptions.filterBy" placeholder="Search"/><\/span>'},compile:function(){return{pre:function(n,t,i,r){n.gridOptions=r.gridOptions},post:function(){}}}}}]).directive("trNgGridPager",[function(){var t=function(n,t){n.gridOptions=t.gridOptions;n.isPaged=!!n.gridOptions.pageItems;n.totalItemsCount=typeof n.gridOptions.totalItems!="undefined"&&n.gridOptions.totalItems!=null?n.gridOptions.totalItems:n.gridOptions.items?n.gridOptions.items.length:0;n.startItemIndex=n.isPaged?n.gridOptions.pageItems*n.gridOptions.currentPage:0;n.endItemIndex=n.isPaged?n.startItemIndex+n.gridOptions.pageItems-1:n.totalItemsCount-1;n.endItemIndex>=n.totalItemsCount&&(n.endItemIndex=n.totalItemsCount-1);n.endItemIndex<n.startItemIndex&&(n.endItemIndex=n.startItemIndex);n.lastPageIndex=!n.totalItemsCount||!n.isPaged?0:Math.floor(n.totalItemsCount/n.gridOptions.pageItems)+(n.totalItemsCount%n.gridOptions.pageItems?0:-1);n.pageIndexes=[];for(var i=0;i<=n.lastPageIndex;i++)n.pageIndexes.push(i);n.pageSelectionActive=n.pageIndexes.length>1;n.pageCanGoBack=n.isPaged&&n.gridOptions.currentPage>0;n.pageCanGoForward=n.isPaged&&n.gridOptions.currentPage<n.lastPageIndex;n.navigateToPage=function(t,i){n.gridOptions.currentPage=i;t.preventDefault();t.stopPropagation()};n.switchPageSelection=function(t,i){n.pageSelectionActive=i;t&&(t.preventDefault(),t.stopPropagation())}};return{restrict:"A",scope:!0,require:"^"+n,template:function(){return'<span class="pull-right form-group"><ul class="pagination"><li ng-show="pageCanGoBack" ><a href="#" ng-click="navigateToPage($event, 0)" title="First Page">|&lArr;<\/a><\/li><li ng-show="pageCanGoBack" ><a href="#" ng-click="navigateToPage($event, gridOptions.currentPage - 1)" title="Previous Page">&lArr;<\/a><\/li><li ng-show="pageSelectionActive" style="white-space: nowrap;"><span>Page: <select ng-model="gridOptions.currentPage" ng-options="pageIndex as (pageIndex+1) for pageIndex in pageIndexes"><\/select><\/span><\/li><li class="disabled" style="white-space: nowrap;"><span ng-hide="totalItemsCount">No items to display<\/span><span ng-show="totalItemsCount" title="Select Page">  {{startItemIndex+1}} - {{endItemIndex+1}} displayed<span>, {{totalItemsCount}} in total<\/span><\/span > <\/li><li ng-show="pageCanGoForward"><a href="#" ng-click="navigateToPage($event, gridOptions.currentPage + 1)" title="Next Page">&rArr;<\/a><\/li><li><li ng-show="pageCanGoForward"><a href="#" ng-show="pageCanGoForward" ng-click="navigateToPage($event, lastPageIndex)" title="Last Page">&rArr;|<\/a><\/li><\/ul><\/span>'},replace:!0,link:{pre:function(n,i,r,u){t(n,u)},post:function(n,i,r,u){n.$watch("[gridOptions.currentPage, gridOptions.items.length, gridOptions.totalItems, gridOptions.pageItems]",function(i,r){for(var f=0;f<i.length;f++)if(i[f]!=r[f]){t(n,u);return}},!0)}}}}])})(TrNgGrid||(TrNgGrid={}));
/*
//# sourceMappingURL=trNgGrid.min.js.map
*/