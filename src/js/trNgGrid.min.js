"use strict";var TrNgGrid;(function(n){var t,i,u,s,f,e,o,a,v;(function(n){n[n.None=0]="None";n[n.SingleRow=1]="SingleRow";n[n.MultiRow=2]="MultiRow";n[n.MultiRowWithKeyModifiers=3]="MultiRowWithKeyModifiers"})(n.SelectionMode||(n.SelectionMode={}));t=n.SelectionMode;i="trNgGrid";n.dataPagingFilter=i+"DataPagingFilter";n.columnTitleDisplayNameFilter=i+"ColumnTitleDisplayNameFilter";u="trNgGridHeader";s="tr-ng-grid-header";n.columnHeaderTemplateId=u+".html";var h="tr-ng-grid-body",c="trNgGridFooter",y="tr-ng-grid-footer";n.footerTemplateId=c+".html";f="trNgGridGlobalFilter";n.globalFilterDirectiveAttribute="tr-ng-grid-global-filter";n.footerGlobalFilterTemplateId=f+".html";e="trNgGridPager";n.pagerDirectiveAttribute="tr-ng-grid-pager";n.footerPagerTemplateId=e+".html";var r="tr-ng-grid-column",p=r+"-auto",l="trNgGridColumnSort";n.columnSortDirectiveAttribute="tr-ng-grid-column-sort";n.columnSortTemplateId=l+".html";o="trNgGridColumnFilter";n.columnFilterDirectiveAttribute="tr-ng-grid-column-filter";n.columnFilterTemplateId=o+".html";a="tr-ng-grid-row-page-item-index";n.tableCssClass="tr-ng-grid table table-bordered table-hover";n.cellCssClass="tr-ng-cell";n.columnContentsCssClass="tr-ng-column-header "+n.cellCssClass;n.columnTitleCssClass="tr-ng-title";n.columnSortCssClass="tr-ng-sort";n.columnFilterCssClass="tr-ng-column-filter";n.columnFilterInputWrapperCssClass="";n.columnSortActiveCssClass="tr-ng-sort-active text-info";n.columnSortInactiveCssClass="tr-ng-sort-inactive text-muted";n.columnSortReverseOrderCssClass="tr-ng-sort-order-reverse glyphicon glyphicon-chevron-up";n.columnSortNormalOrderCssClass="tr-ng-sort-order-normal glyphicon glyphicon-chevron-down";n.rowSelectedCssClass="active";n.footerCssClass="tr-ng-grid-footer form-inline";n.splitByCamelCasing=function(n){var t=n.split(/(?=[A-Z])/);return t.length&&t[0].length&&(t[0]=t[0][0].toLocaleUpperCase()+t[0].substr(1)),t.join(" ")};v=function(){function i(i,r,u,f,e,o){var s=this,h;this.$compile=i;this.$parse=e;this.$timeout=o;this.gridElement=u;this.internalScope=r;r.TrNgGrid=n;this.scheduledRecompilationDereg=null;h="gridOptions";this.gridOptions={items:[],selectedItems:[],filterBy:null,filterByFields:{},orderBy:null,orderByReverse:!1,pageItems:null,currentPage:0,totalItems:null,enableFiltering:!0,enableSorting:!0,enableSelections:!0,enableMultiRowSelections:!0,selectionMode:t[2],onDataRequiredDelay:1e3};this.gridOptions.onDataRequired=f.onDataRequired?r.onDataRequired:null;this.gridOptions.gridColumnDefs=[];this.internalScope[h]=this.gridOptions;this.externalScope=this.internalScope.$parent;this.linkScope(this.internalScope,this.externalScope,h,f);this.gridOptions.onDataRequired&&r.$watchCollection("[gridOptions.filterBy, gridOptions.filterByFields, gridOptions.orderBy, gridOptions.orderByReverse, gridOptions.currentPage]",function(){s.dataRequestPromise&&(s.$timeout.cancel(s.dataRequestPromise),s.dataRequestPromise=null);s.dataRequestPromise=s.$timeout(function(){s.dataRequestPromise=null;s.gridOptions.onDataRequired(s.gridOptions)},s.gridOptions.onDataRequiredDelay,!0)});this.internalScope.$watch(h+".enableMultiRowSelections",function(n,i){n!==i&&(n?(s.gridOptions.selectionMode=t[2],s.gridOptions.enableSelections=!0):s.gridOptions.enableSelections&&(s.gridOptions.selectionMode=t[1]))});this.internalScope.$watch(h+".enableSelections",function(n,i){n!==i&&(n?s.gridOptions.selectionMode===t[0]&&(s.gridOptions.selectionMode=t[1]):(s.gridOptions.enableMultiRowSelections=!1,s.gridOptions.selectionMode=t[0]))});this.internalScope.$watch(h+".selectionMode",function(n,i){if(n!==i)switch(n){case t[0]:s.gridOptions.selectedItems.splice(0);break;case t[1]:s.gridOptions.selectedItems.length>1&&s.gridOptions.selectedItems.splice(1)}})}return i.prototype.setColumnOptions=function(n,t){n>=this.gridOptions.gridColumnDefs.length?(this.gridOptions.gridColumnDefs.push({}),this.setColumnOptions(n,t)):this.gridOptions.gridColumnDefs[n]=t},i.prototype.toggleSorting=function(n){this.gridOptions.orderBy!=n?this.gridOptions.orderBy=n:this.gridOptions.orderByReverse=!this.gridOptions.orderByReverse},i.prototype.setFilter=function(n,t){t?this.gridOptions.filterByFields[n]=t:delete this.gridOptions.filterByFields[n];this.gridOptions.filterByFields=$.extend({},this.gridOptions.filterByFields)},i.prototype.toggleItemSelection=function(n,i){var s,u,f,h,e,o,r;if(this.gridOptions.selectionMode!==t[0])switch(this.gridOptions.selectionMode){case t[3]:if(i.ctrlKey||i.shiftKey||i.metaKey){if(i.ctrlKey||i.metaKey)r=this.gridOptions.selectedItems.indexOf(n),r>=0?this.gridOptions.selectedItems.splice(r,1):this.gridOptions.selectedItems.push(n);else if(i.shiftKey){if(document.selection&&document.selection.empty?document.selection.empty():window.getSelection&&(s=window.getSelection(),s.removeAllRanges()),u=-1,this.gridOptions.selectedItems.length>0&&(u=this.gridOptions.items.indexOf(this.gridOptions.selectedItems[this.gridOptions.selectedItems.length-1])),u<0&&(u=0),f=this.gridOptions.items.indexOf(n),f<0)throw"Invalid selection on a key modifier selection mode";for(f<u&&(h=u,u=f,f=h),e=u;e<=f;e++)o=this.gridOptions.items[e],this.gridOptions.selectedItems.indexOf(o)<0&&this.gridOptions.selectedItems.push(o)}}else r=this.gridOptions.selectedItems.indexOf(n),this.gridOptions.selectedItems.splice(0),r<0&&this.gridOptions.selectedItems.push(n);break;case t[1]:r=this.gridOptions.selectedItems.indexOf(n);this.gridOptions.selectedItems.splice(0);r<0&&this.gridOptions.selectedItems.push(n);break;case t[2]:r=this.gridOptions.selectedItems.indexOf(n);r>=0?this.gridOptions.selectedItems.splice(r,1):this.gridOptions.selectedItems.push(n)}},i.prototype.scheduleRecompilationOnAvailableItems=function(){var n=this;this.scheduledRecompilationDereg||this.gridOptions.items&&this.gridOptions.items.length||(this.scheduledRecompilationDereg=this.internalScope.$watch("items.length",function(t){t>0&&(n.scheduledRecompilationDereg(),n.$compile(n.gridElement)(n.externalScope))}))},i.prototype.linkScope=function(n,t,i,r){var f=n[i],u,o,s,e;for(u in f)if(o=typeof r[u]!="undefined"&&r[u]!=null,o){s=!1;typeof n[u]!="undefined"&&n[u]!=null&&(f[u]=n[u],s=f[u]instanceof Array);e=null;try{e=this.$parse(r[u])}catch(h){}(function(r,u){u&&u.constant||n.$watch(r,function(n,t){n!==t&&(f[r]=n)});var e=u&&u.assign?u.assign:null;e&&n.$watch(i+"."+r,function(n,i){n!==i&&e(t,n)})})(u,e)}},i}();angular.module("trNgGrid",[]).directive(i,[function(){return{restrict:"A",scope:{items:"=",selectedItems:"=?",filterBy:"=?",filterByFields:"=?",orderBy:"=?",orderByReverse:"=?",pageItems:"=?",currentPage:"=?",totalItems:"=?",enableFiltering:"=?",enableSorting:"=?",enableSelections:"=?",enableMultiRowSelections:"=?",selectionMode:"@",onDataRequired:"&",onDataRequiredDelay:"=?",fields:"=?"},controller:["$compile","$scope","$element","$attrs","$parse","$timeout",v],compile:function(t){var c,l,u,e,i,a,f,o,v,p;return t.addClass(n.tableCssClass),c=!1,l=!1,u=t.find("thead").first(),u.length==0&&(u=angular.element("<table><thead><\/thead><\/table>").find("thead"),l=!0),e=u.children("tr"),e.length==0&&(e=$("<tr>").appendTo(u)),e.attr(s,""),e.children("th[field-name]").attr(r,""),i=t.children("tbody"),i.length===0&&(i=$("<tbody>").appendTo(t)),a=i.children("tr"),a.length===0&&(a=$("<tr>").appendTo(i)),i.attr(h,""),f=t.children("tfoot"),f.length==0&&(f=$("<tfoot>"),c=!0),o=f.children("tr"),o.length==0&&(o=$("<tr>").appendTo(f)),o.children("td").length==0&&(v=$("<td>").attr("colspan","999").appendTo(o),p=$("<div>").attr(y,"").appendTo(v)),l&&t.prepend(u),c&&f.insertBefore(i),{pre:function(){}}}}}]).directive(u,["$compile",function(n){return{restrict:"A",scope:!1,require:"^"+i,compile:function(){return{pre:function(t,i,u,f){var e,s,o,h;if(i.children("th").length==0)if(f.gridOptions.items&&f.gridOptions.items.length>0){e=[];for(s in f.gridOptions.items[0])s.match(/^[_\$]/g)||e.push(s);for(o=0;o<e.length;o++)h=$("<th>").attr(r,"").attr("field-name",e[o]).appendTo(i),n(h)(t)}else f.scheduleRecompilationOnAvailableItems()}}}}}]).directive("trNgGridColumn",["$compile",function(){return{restrict:"A",require:"^"+i,scope:{fieldName:"@",displayName:"@",enableFiltering:"@",enableSorting:"@",displayAlign:"@",displayFormat:"@",cellWidth:"@",cellHeight:"@"},templateUrl:n.columnHeaderTemplateId,transclude:!0,compile:function(){var n;return{pre:function(t,i,r,u,f){var o=i.prop("tagName")=="TH",e;if(!o)throw"The template has an invalid header column template element. Column templates must be defined on TH elements inside THEAD/TR";(e=!1,f(function(n){e=n.children().length>0}),t.isCustomized=e,t.gridOptions=u.gridOptions,t.cellWidth&&i.css("width",t.cellWidth),t.cellHeight&&i.css("height",t.cellHeight),n=i.parent().children("th").index(i),n<0)||u.setColumnOptions(n,t)}}}}}]).directive(l,[function(){return{restrict:"A",replace:!0,templateUrl:n.columnSortTemplateId}}]).directive(o,[function(){return{restrict:"A",replace:!0,templateUrl:n.columnFilterTemplateId}}]).directive("trNgGridBody",["$compile",function(t){return{restrict:"A",scope:!0,require:"^"+i,replace:!0,compile:function(i){var u=i.children("tr");return i.contents().remove(),{pre:function(i,f,e,o){i.gridOptions=o.gridOptions;i.toggleItemSelection=function(n,t){return o.toggleItemSelection(n,t)};i.$watchCollection("gridOptions.gridColumnDefs",function(e){var s="gridItem in gridOptions.items",o;i.gridOptions.onDataRequired||(s+=" | filter:gridOptions.filterBy | filter:gridOptions.filterByFields | orderBy:gridOptions.orderBy:gridOptions.orderByReverse | "+n.dataPagingFilter+":gridOptions");o=u.clone(!0);o.attr("ng-repeat",s);o.attr("ng-click")||o.attr("ng-click","toggleItemSelection(gridItem, $event)");o.attr("ng-class","{'"+n.rowSelectedCssClass+"':gridOptions.selectedItems.indexOf(gridItem)>=0}");o.attr(a,"{{$index}}");angular.forEach(e,function(t,i){var r=o.children("td:nth-child("+(i+1)+")"),h=r.attr("field-name"),s=!1,e,u,f;h!==t.fieldName?(s=!0,e=$("<td>"),r.length==0?o.append(e):r.before(e),r=e):s=r.text()=="";s&&(u=$("<div>").addClass(n.cellCssClass),t.fieldName?(u.attr("field-name",t.fieldName),f="{{gridItem."+t.fieldName,t.displayFormat&&(t.displayFormat[0]!="|"&&t.displayFormat[0]!="."&&(f+=" | "),f+=t.displayFormat),f+="}}",u.text(f)):u.text("Invalid column match inside the table body"),r.append(u));t.displayAlign&&r.addClass("text-"+t.displayAlign);t.cellWidth&&r.css("width",t.cellWidth);t.cellHeight&&r.css("height",t.cellHeight)});f.contents().remove();f.append(t(o)(i));f.removeAttr(h);f.children("td["+r+"]").removeAttr(r)})},post:function(){}}}}}]).directive(c,[function(){return{restrict:"A",scope:!1,require:"^"+i,replace:!0,templateUrl:n.footerTemplateId}}]).directive(f,[function(){return{restrict:"A",replace:!0,scope:!0,require:"^"+i,templateUrl:n.footerGlobalFilterTemplateId,compile:function(){return{pre:function(n,t,i,r){n.gridOptions=r.gridOptions},post:function(){}}}}}]).directive(e,[function(){var t=function(n,t){n.gridOptions=t.gridOptions;n.isPaged=!!n.gridOptions.pageItems;n.totalItemsCount=typeof n.gridOptions.totalItems!="undefined"&&n.gridOptions.totalItems!=null?n.gridOptions.totalItems:n.gridOptions.items?n.gridOptions.items.length:0;n.startItemIndex=n.isPaged?n.gridOptions.pageItems*n.gridOptions.currentPage:0;n.endItemIndex=n.isPaged?n.startItemIndex+n.gridOptions.pageItems-1:n.totalItemsCount-1;n.endItemIndex>=n.totalItemsCount&&(n.endItemIndex=n.totalItemsCount-1);n.endItemIndex<n.startItemIndex&&(n.endItemIndex=n.startItemIndex);n.lastPageIndex=!n.totalItemsCount||!n.isPaged?0:Math.floor(n.totalItemsCount/n.gridOptions.pageItems)+(n.totalItemsCount%n.gridOptions.pageItems?0:-1);n.pageIndexes=[];for(var i=0;i<=n.lastPageIndex;i++)n.pageIndexes.push(i);n.pageSelectionActive=n.pageIndexes.length>1;n.pageCanGoBack=n.isPaged&&n.gridOptions.currentPage>0;n.pageCanGoForward=n.isPaged&&n.gridOptions.currentPage<n.lastPageIndex;n.navigateToPage=function(t,i){n.gridOptions.currentPage=i;t.preventDefault();t.stopPropagation()};n.switchPageSelection=function(t,i){n.pageSelectionActive=i;t&&(t.preventDefault(),t.stopPropagation())}};return{restrict:"A",scope:!0,require:"^"+i,templateUrl:n.footerPagerTemplateId,replace:!0,link:{pre:function(n,i,r,u){t(n,u)},post:function(n,i,r,u){n.$watchCollection("[gridOptions.currentPage, gridOptions.items.length, gridOptions.totalItems, gridOptions.pageItems]",function(){t(n,u)})}}}}]).filter(n.dataPagingFilter,function(){return function(n,t){var i,r;return(n&&(t.totalItems=n.length),!t.pageItems||!n||n.length==0)?n:(t.currentPage||(t.currentPage=0),i=t.currentPage*t.pageItems,i>=n.length&&(t.currentPage=0,i=0),r=t.currentPage*t.pageItems+t.pageItems,n.slice(i,r))}}).filter(n.columnTitleDisplayNameFilter,function(){return function(t,i){return typeof t=="undefined"?n.splitByCamelCasing(i):t}}).run(["$templateCache",function(t){t.put(n.columnHeaderTemplateId,'<div class="'+n.columnContentsCssClass+'">  <div ng-if="!isCustomized">    <div class="'+n.columnTitleCssClass+'">      {{displayName |'+n.columnTitleDisplayNameFilter+":fieldName}}       <div "+n.columnSortDirectiveAttribute+" />    <\/div>    <div "+n.columnFilterDirectiveAttribute+'/>  <\/div>  <div ng-if="isCustomized">    <div ng-transclude/>  <\/div><\/div>');t.put(n.columnFilterTemplateId,"<div ng-show='enableFiltering||gridOptions.enableFiltering' class='"+n.columnFilterCssClass+"'> <div class='"+n.columnFilterInputWrapperCssClass+"'>   <input class='form-control input-sm' type='text' ng-model='filter'/> <\/div><\/div>");t.put(n.columnSortTemplateId,"<div ng-show='enableSorting||gridOptions.enableSorting' ng-click='toggleSorting(fieldName)' title='Sort' class='"+n.columnSortCssClass+"'>  <div ng-class=\"{'"+n.columnSortActiveCssClass+"':gridOptions.orderBy==fieldName,'"+n.columnSortInactiveCssClass+"':gridOptions.orderBy!=fieldName,'"+n.columnSortNormalOrderCssClass+"':gridOptions.orderBy!=fieldName||!gridOptions.orderByReverse,'"+n.columnSortReverseOrderCssClass+"':gridOptions.orderBy==fieldName&&gridOptions.orderByReverse}\" >  <\/div><\/div>");t.put(n.footerTemplateId,'<div class="'+n.footerCssClass+'">  <span '+n.globalFilterDirectiveAttribute+'=""/>  <span '+n.pagerDirectiveAttribute+'=""/><\/div>');t.put(n.footerGlobalFilterTemplateId,'<span ng-show="gridOptions.enableFiltering" class="pull-left form-group">  <input class="form-control" type="text" ng-model="gridOptions.filterBy" placeholder="Search"/><\/span>');t.put(n.footerPagerTemplateId,'<span class="pull-right form-group"> <ul class="pagination">   <li ng-show="pageCanGoBack" >     <a href="#" ng-click="navigateToPage($event, 0)" title="First Page">|&lArr;<\/a>   <\/li>   <li ng-show="pageCanGoBack" >     <a href="#" ng-click="navigateToPage($event, gridOptions.currentPage - 1)" title="Previous Page">&lArr;<\/a>   <\/li>   <li ng-show="pageSelectionActive" style="white-space: nowrap;">     <span>Page:        <select ng-model="gridOptions.currentPage" ng-options="pageIndex as (pageIndex+1) for pageIndex in pageIndexes"><\/select>     <\/span>   <\/li>   <li class="disabled" style="white-space: nowrap;">     <span ng-hide="totalItemsCount">No items to display<\/span>     <span ng-show="totalItemsCount" title="Select Page">       {{startItemIndex+1}} - {{endItemIndex+1}} displayed     <span>, {{totalItemsCount}} in total<\/span>     <\/span >    <\/li>   <li ng-show="pageCanGoForward">     <a href="#" ng-click="navigateToPage($event, gridOptions.currentPage + 1)" title="Next Page">&rArr;<\/a>   <\/li>   <li>   <li ng-show="pageCanGoForward">     <a href="#" ng-show="pageCanGoForward" ng-click="navigateToPage($event, lastPageIndex)" title="Last Page">&rArr;|<\/a>   <\/li> <\/ul><\/span>')}])})(TrNgGrid||(TrNgGrid={}));