var TrNgGrid;(function(e){var k="trNgGrid";var g="trNgGridHeader";var d="tr-ng-grid-header";var u="trNgGridBody";var z="tr-ng-grid-body";var h="trNgGridGlobalFilter";var t="tr-ng-grid-global-filter";var v="trNgGridPager";var o="tr-ng-grid-pager";var s="trNgGridColumn";var i="tr-ng-grid-column";var f="trNgGridColumnSort";var B="tr-ng-grid-column-sort";var c="trNgGridColumnFilter";var n="tr-ng-grid-column-filter";var j="tr-ng-grid-row-page-item-index";var y="tr-ng-grid table table-bordered table-hover";var m="tr-ng-cell";var a="tr-ng-title";var w="tr-ng-sort btn btn-default";var l="tr-ng-column-filter";var b="tr-ng-sort-active";var x="tr-ng-sort-inactive";var q="tr-ng-sort-reverse";var r="active";var A="navbar navbar-default";var p=(function(){function C(H,G,F,D,E,I){this.$compile=H;this.$parse=I;this.gridElement=F;this.internalScope=G;this.scheduledRecompilationDereg=null;var J="gridOptions";this.gridOptions={items:[],selectedItems:[],filterBy:null,filterByFields:{},orderBy:null,orderByReverse:false,pageItems:null,currentPage:0,totalItems:null};this.gridOptions.gridColumnDefs=[];G[J]=this.gridOptions;this.externalScope=this.internalScope.$parent;this.linkScope(this.internalScope,J,D)}C.prototype.setColumnOptions=function(D,E){if(D>=this.gridOptions.gridColumnDefs.length){this.gridOptions.gridColumnDefs.push({});this.setColumnOptions(D,E)}else{this.gridOptions.gridColumnDefs[D]=E}};C.prototype.toggleSorting=function(D){if(this.gridOptions.orderBy!=D){this.gridOptions.orderBy=D}else{this.gridOptions.orderByReverse=!this.gridOptions.orderByReverse}};C.prototype.setFilter=function(D,E){if(!E){delete (this.gridOptions.filterByFields[D])}else{this.gridOptions.filterByFields[D]=E}};C.prototype.setCellStyle=function(D,E){if(E.cellWidth){D.css("width",E.cellWidth)}if(E.cellHeight){D.css("height",E.cellHeight)}};C.prototype.toggleItemSelection=function(E){var D=this.gridOptions.selectedItems.indexOf(E);if(D>=0){this.gridOptions.selectedItems.splice(D,1)}else{this.gridOptions.selectedItems.push(E)}};C.prototype.scheduleRecompilationOnAvailableItems=function(){var D=this;if(this.scheduledRecompilationDereg||(this.gridOptions.items&&this.gridOptions.items.length)){return}this.scheduledRecompilationDereg=this.internalScope.$watch("items.length",function(F,E){if(F>0){D.scheduledRecompilationDereg();D.$compile(D.gridElement)(D.externalScope)}})};C.prototype.linkScope=function(L,D,I){var G=L[D];for(var E in G){var K=typeof(I[E])!="undefined"&&I[E]!=null;if(K){var F=false;if(typeof(L[E])!="undefined"&&L[E]!=null){G[E]=L[E];F=G[E] instanceof Array}if(!F){var J=this.$parse(I[E]);var H=typeof(J)!="array"&&J&&J.assign;if(H){(function(M){L.$watch(D+"."+M,function(O,N){if(O!==N){L[M]=G[M]}});L.$watch(M,function(O,N){if(O!==N){G[M]=L[M]}})})(E)}}}}};C.prototype.splitByCamelCasing=function(E){var D=E.split(/(?=[A-Z])/);if(D.length&&D[0].length){D[0]=D[0][0].toLocaleUpperCase()+D[0].substr(1)}return D.join(" ")};return C})();angular.module("trNgGrid",[]).directive(k,[function(){return{restrict:"A",scope:{items:"=",selectedItems:"=?",filterBy:"=?",filterByFields:"=?",orderBy:"=?",orderByReverse:"=?",pageItems:"=?",currentPage:"=?",totalItems:"=?"},controller:["$compile","$scope","$element","$attrs","$transclude","$parse",p],compile:function(G,E){G.addClass(y);var J=false;var N=false;var C=G.children("thead");if(C.length==0){C=$("<thead>");N=true}var L=C.children("tr");if(L.length==0){L=$("<tr>").appendTo(C)}L.attr(d,"");var H=G.children("tbody");if(H.length===0){H=$("<tbody>").appendTo(G)}var I=H.children("tr");if(I.length===0){I=$("<tr>").appendTo(H)}H.attr(z,"");var M=G.children("tfoot");if(M.length==0){M=$("<tfoot>");J=true}var K=M.children("tr");if(K.length==0){K=$("<tr>").appendTo(M)}if(K.children("td").length==0){var D=$("<td>").attr("colspan","999").appendTo(K);var F=$("<div>").addClass(A).appendTo(D);$("<div>").attr(t,"").appendTo(F);$("<div>").attr(o,"").appendTo(F)}if(N){G.prepend(C)}if(J){M.insertBefore(H)}}}}]).directive(g,["$compile",function(C){return{restrict:"A",scope:false,require:"^"+k,compile:function(E,D){return{pre:function(G,J,F,I){if(J.children("th").length==0){if(I.gridOptions.items&&I.gridOptions.items.length>0){for(var H in I.gridOptions.items[0]){if(!H.match(/^[_\$]/g)){var K=$("<th>").attr(i,"").attr("field-name",H).appendTo(J);C(K)(G)}}}else{I.scheduleRecompilationOnAvailableItems()}}}}}}}]).directive(s,["$compile",function(C){return{restrict:"A",scope:true,require:"^"+k,compile:function(F,E){var D;return{pre:function(I,K,H,G){var J=K.prop("tagName")=="TH";if(!J){throw"The template has an invalid header column template element. Column templates must be defined on TH elements inside THEAD/TR"}D=K.parent().children("th").index(K);if(D<0){return}I.currentGridColumnDef={fieldName:H.fieldName,disableFiltering:H.disableFiltering=="true",disableSorting:H.disableSorting=="true",cellWidth:H.cellWidth,cellHeight:H.cellHeight};I.gridOptions=G.gridOptions;I.toggleSorting=function(L){return G.toggleSorting(L)};I.filter="";I.$watch("filter",function(M,L){if(M!==L){G.setFilter(I.currentGridColumnDef.fieldName,M)}});G.setColumnOptions(D,I.currentGridColumnDef);K.removeAttr(i)},post:function(I,J,H,G){if(I.currentGridColumnDef){if(!I.currentGridColumnDef.fieldName){throw"The column definition for trNgGrid must contain the field name"}G.setCellStyle(J,I.currentGridColumnDef);if(J.text()==""){var K=$("<div>").addClass(m);$("<span>").addClass(a).text(G.splitByCamelCasing(I.currentGridColumnDef.fieldName)).appendTo(K);if(!I.currentGridColumnDef.disableSorting){$("<span>").attr(B,"").appendTo(K)}if(!I.currentGridColumnDef.disableFiltering){$("<div>").attr(n,"").appendTo(K)}J.append(C(K)(I))}}}}}}}]).directive(f,[function(){return{restrict:"A",replace:true,template:"<div class='"+w+"' ng-click='toggleSorting(currentGridColumnDef.fieldName)'><span ng-class=\"{'"+b+"':gridOptions.orderBy==currentGridColumnDef.fieldName,'"+x+"':gridOptions.orderBy!=currentGridColumnDef.fieldName,'"+q+"':gridOptions.orderByReverse}\"  ></span></div>",link:function(E,F,D,C){}}}]).directive(c,[function(){return{restrict:"A",replace:true,template:"<div class='"+l+"'><input class='form-control input-sm' type='text' ng-model='filter'/></div>"}}]).filter("paging",function(){return function(C,D,G){if(!G||!C||C.length==0){return C}if(!D){D=0}var F=D*G;var E=D*G+G;if(F>=C.length){return C}return C.slice(F,E)}}).directive(u,["$compile",function(D){var C="trNgOriginalBodyTemplate";return{restrict:"A",scope:true,require:"^"+k,replace:false,compile:function(G,F){var E=G.children("tr");G.contents().remove();return{post:function(J,K,I,H){J.gridOptions=H.gridOptions;J.toggleItemSelection=function(L){return H.toggleItemSelection(L)};E.attr("ng-repeat","gridItem in gridOptions.items | filter:gridOptions.filterBy | filter:gridOptions.filterByFields | orderBy:gridOptions.orderBy:gridOptions.orderByReverse | paging:gridOptions.currentPage:gridOptions.pageItems");if(!E.attr("ng-click")){E.attr("ng-click","toggleItemSelection(gridItem)")}E.attr("ng-class","{'"+r+"':gridOptions.selectedItems.indexOf(gridItem)>=0}");E.attr(j,"{{$index}}");angular.forEach(J.gridOptions.gridColumnDefs,function(P,M){var L=E.children("td:nth-child("+(M+1)+")");var O=!!L.attr(i);if((O&&!P.fieldName)||(!O&&P.fieldName)){var N=$("<div>").addClass(m);if(P.fieldName){N.attr(i);N.text("{{gridItem."+P.fieldName+"}}")}else{N.text("Invalid column match inside the table body")}N=$("<td>").append(N);if(L.length==0){E.append(N)}else{L.before(N)}L=N}H.setCellStyle(L,P)});E.children("td["+i+"]").removeAttr(i);E.removeAttr(z);K.append(D(E)(J))}}}}}]).directive(h,[function(){return{restrict:"A",scope:true,require:"^"+k,template:'<div class="navbar-form navbar-left"><input class="form-control" type="text" ng-model="gridOptions.filterBy" placeholder="Search"/></div>',replace:true,link:{pre:function(E,F,D,C){E.gridOptions=C.gridOptions}}}}]).directive(v,[function(){var C=function(E,D){E.gridOptions=D.gridOptions;E.isPaged=!!E.gridOptions.pageItems;E.totalItemsCount=(typeof(E.gridOptions.totalItems)!="undefined"&&E.gridOptions.totalItems!=null)?E.gridOptions.totalItems:(E.gridOptions.items?E.gridOptions.items.length:0);E.startItemIndex=E.isPaged?(E.gridOptions.pageItems*E.gridOptions.currentPage):0;E.endItemIndex=E.isPaged?(E.startItemIndex+E.gridOptions.pageItems-1):E.totalItemsCount-1;if(E.endItemIndex>=E.totalItemsCount){E.endItemIndex=E.totalItemsCount-1}if(E.endItemIndex<E.startItemIndex){E.endItemIndex=E.startItemIndex}E.pageCanGoBack=E.isPaged&&E.gridOptions.currentPage>0;E.pageCanGoForward=E.isPaged&&E.endItemIndex<E.totalItemsCount-1};return{restrict:"A",scope:true,require:"^"+k,template:'<div class="navbar-left"><button ng-show="pageCanGoBack" ng-click="gridOptions.currentPage=gridOptions.currentPage-1" type="button" class="btn btn-default navbar-btn navbar-left">Prev Page</button><p class="navbar-text navbar-left" style="white-space: nowrap;"><span ng-hide="totalItemsCount">No items to display</span><span ng-show="totalItemsCount">  {{startItemIndex+1}} - {{endItemIndex+1}} displayed<span>, {{totalItemsCount}} in total</span></span></p><button ng-show="pageCanGoForward" ng-click="gridOptions.currentPage=gridOptions.currentPage+1" type="button" class="btn btn-default navbar-btn navbar-left">Next Page</button></div>',replace:true,link:{pre:function(F,G,E,D){C(F,D);F.$watchCollection("[gridOptions.currentPage, gridOptions.items.length, gridOptions.totalItems, gridOptions.pageItems]",function(I,H){if(I!==H){C(F,D)}})}}}}])})(TrNgGrid||(TrNgGrid={}));