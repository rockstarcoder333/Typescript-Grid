var TrNgGrid;(function(n){var t="trNgGrid",e="tr-ng-grid-header",r="tr-ng-grid-body",o="tr-ng-grid-footer",s="tr-ng-grid-global-filter",h="tr-ng-grid-pager",i="tr-ng-grid-column",c="tr-ng-grid-column-sort",l="tr-ng-grid-column-filter",u,f;n.columnFilterTemplateId="trNgGrid-column-filter.html";n.columnSortTemplateId="trNgGrid-column-sort.html";u="tr-ng-grid-row-page-item-index";n.tableCssClass="tr-ng-grid table table-bordered table-hover";n.cellCssClass="tr-ng-cell";n.columnHeaderContentsCssClass="tr-ng-column-header";n.titleCssClass="tr-ng-title";n.sortCssClass="tr-ng-sort";n.filterColumnCssClass="tr-ng-column-filter";n.filterInputWrapperCssClass="";n.sortActiveCssClass="tr-ng-sort-active text-info";n.sortInactiveCssClass="tr-ng-sort-inactive text-muted";n.sortReverseOrderCssClass="tr-ng-sort-order-reverse glyphicon glyphicon-chevron-up";n.sortNormalOrderCssClass="tr-ng-sort-order-normal glyphicon glyphicon-chevron-down";n.selectedRowCssClass="active";n.footerOpsContainerCssClass="tr-ng-grid-footer form-inline";f=function(){function n(n,t,i,r,u,f,e){var o=this,s;this.$compile=n;this.$parse=f;this.$timeout=e;this.gridElement=i;this.internalScope=t;this.scheduledRecompilationDereg=null;s="gridOptions";this.gridOptions={items:[],selectedItems:[],filterBy:null,filterByFields:{},orderBy:null,orderByReverse:!1,pageItems:null,currentPage:0,totalItems:null,enableFiltering:!0,enableSorting:!0,enableSelections:!0,enableMultiRowSelections:!0,onDataRequiredDelay:1e3};this.gridOptions.onDataRequired=r.onDataRequired?t.onDataRequired:null;this.gridOptions.gridColumnDefs=[];t[s]=this.gridOptions;this.externalScope=this.internalScope.$parent;this.linkScope(this.internalScope,s,r);this.gridOptions.onDataRequired&&t.$watchCollection("[gridOptions.filterBy, gridOptions.filterByFields, gridOptions.orderBy, gridOptions.orderByReverse, gridOptions.currentPage]",function(){o.dataRequestPromise&&(o.$timeout.cancel(o.dataRequestPromise),o.dataRequestPromise=null);o.dataRequestPromise=o.$timeout(function(){o.dataRequestPromise=null;o.gridOptions.onDataRequired(o.gridOptions)},o.gridOptions.onDataRequiredDelay,!0)});this.internalScope.$watch("enableMultiRowSelections",function(n,t){n===t||n||o.gridOptions.selectedItems.length>1&&o.gridOptions.selectedItems.splice(1)});this.internalScope.$watch("enableSelections",function(n,t){n===t||n||(o.gridOptions.selectedItems.splice(0),o.gridOptions.enableMultiRowSelections=!1)})}return n.prototype.setColumnOptions=function(n,t){n>=this.gridOptions.gridColumnDefs.length?(this.gridOptions.gridColumnDefs.push({}),this.setColumnOptions(n,t)):this.gridOptions.gridColumnDefs[n]=t},n.prototype.toggleSorting=function(n){this.gridOptions.orderBy!=n?this.gridOptions.orderBy=n:this.gridOptions.orderByReverse=!this.gridOptions.orderByReverse},n.prototype.setFilter=function(n,t){t?this.gridOptions.filterByFields[n]=t:delete this.gridOptions.filterByFields[n];this.gridOptions.filterByFields=$.extend({},this.gridOptions.filterByFields)},n.prototype.toggleItemSelection=function(n){if(this.gridOptions.enableSelections){var t=this.gridOptions.selectedItems.indexOf(n);t>=0?this.gridOptions.selectedItems.splice(t,1):(this.gridOptions.enableMultiRowSelections||this.gridOptions.selectedItems.splice(0),this.gridOptions.selectedItems.push(n))}},n.prototype.scheduleRecompilationOnAvailableItems=function(){var n=this;this.scheduledRecompilationDereg||this.gridOptions.items&&this.gridOptions.items.length||(this.scheduledRecompilationDereg=this.internalScope.$watch("items.length",function(t){t>0&&(n.scheduledRecompilationDereg(),n.$compile(n.gridElement)(n.externalScope))}))},n.prototype.linkScope=function(n,t,i){var u=n[t],r,e,o,f,s;for(r in u)e=typeof i[r]!="undefined"&&i[r]!=null,e&&(o=!1,typeof n[r]!="undefined"&&n[r]!=null&&(u[r]=n[r],o=u[r]instanceof Array),f=this.$parse(i[r]),s=f&&f.assign,s&&function(i){n.$watch(t+"."+i,function(t,r){t!==r&&(n[i]=u[i])});n.$watch(i,function(t,r){t!==r&&(u[i]=n[i])})}(r))},n.prototype.splitByCamelCasing=function(n){var t=n.split(/(?=[A-Z])/);return t.length&&t[0].length&&(t[0]=t[0][0].toLocaleUpperCase()+t[0].substr(1)),t.join(" ")},n}();angular.module("trNgGrid",[]).directive(t,[function(){return{restrict:"A",scope:{items:"=",selectedItems:"=?",filterBy:"=?",filterByFields:"=?",orderBy:"=?",orderByReverse:"=?",pageItems:"=?",currentPage:"=?",totalItems:"=?",enableFiltering:"=?",enableSorting:"=?",enableSelections:"=?",enableMultiRowSelections:"=?",onDataRequired:"&",onDataRequiredDelay:"=?"},controller:["$compile","$scope","$element","$attrs","$transclude","$parse","$timeout",f],compile:function(t){var h,u,l,f,c,y,p;t.addClass(n.tableCssClass);var a=!1,v=!1,s=t.children("thead");s.length==0&&(s=$("<thead>"),v=!0);h=s.children("tr");h.length==0&&(h=$("<tr>").appendTo(s));h.attr(e,"");h.children("th[field-name]").attr(i,"");u=t.children("tbody");u.length===0&&(u=$("<tbody>").appendTo(t));l=u.children("tr");l.length===0&&(l=$("<tr>").appendTo(u));u.attr(r,"");f=t.children("tfoot");f.length==0&&(f=$("<tfoot>"),a=!0);c=f.children("tr");c.length==0&&(c=$("<tr>").appendTo(f));c.children("td").length==0&&(y=$("<td>").attr("colspan","999").appendTo(c),p=$("<div>").attr(o,"").appendTo(y));v&&t.prepend(s);a&&f.insertBefore(u)}}}]).directive("trNgGridHeader",["$compile",function(n){return{restrict:"A",scope:!1,require:"^"+t,compile:function(){return{pre:function(t,r,u,f){var e,s,o,h;if(r.children("th").length==0)if(f.gridOptions.items&&f.gridOptions.items.length>0){e=[];for(s in f.gridOptions.items[0])s.match(/^[_\$]/g)||e.push(s);for(o=0;o<e.length;o++)h=$("<th>").attr(i,"").attr("field-name",e[o]).appendTo(r),n(h)(t)}else f.scheduleRecompilationOnAvailableItems()}}}}}]).directive("trNgGridColumn",["$compile",function(r){return{restrict:"A",scope:!0,require:"^"+t,compile:function(){var t;return{pre:function(n,r,u,f){var o=r.prop("tagName")=="TH",e;if(!o)throw"The template has an invalid header column template element. Column templates must be defined on TH elements inside THEAD/TR";(t=r.parent().children("th").index(r),t<0)||(n.gridOptions=f.gridOptions,n.toggleSorting=function(n){return f.toggleSorting(n)},n.filter="",n.$watch("filter",function(t,i){t!==i&&f.setFilter(n.currentGridColumnDef.fieldName,t)}),e=function(){n.currentGridColumnDef.fieldName=u.fieldName;n.currentGridColumnDef.displayName=typeof u.displayName=="undefined"?f.splitByCamelCasing(u.fieldName):u.displayName;n.currentGridColumnDef.enableFiltering=u.enableFiltering=="true"||typeof u.enableFiltering=="undefined"&&n.gridOptions.enableFiltering;n.currentGridColumnDef.enableSorting=u.enableSorting=="true"||typeof u.enableSorting=="undefined"&&n.gridOptions.enableSorting;n.currentGridColumnDef.displayAlign=u.displayAlign;n.currentGridColumnDef.displayFormat=u.displayFormat;n.currentGridColumnDef.cellWidth=u.cellWidth;n.currentGridColumnDef.cellHeight=u.cellHeight},n.currentGridColumnDef={},e(),n.$watchCollection("[gridOptions.enableFiltering,gridOptions.enableSorting]",function(){e()}),f.setColumnOptions(t,n.currentGridColumnDef),r.removeAttr(i))},post:function(t,i){if(t.currentGridColumnDef){if(!t.currentGridColumnDef.fieldName)throw"The column definition for trNgGrid must contain the field name";if(t.currentGridColumnDef.cellWidth&&i.css("width",t.currentGridColumnDef.cellWidth),t.currentGridColumnDef.cellHeight&&i.css("height",t.currentGridColumnDef.cellHeight),i.text()==""){var u=$("<div>").addClass(n.cellCssClass).addClass(n.columnHeaderContentsCssClass),f=$("<div>").addClass(n.titleCssClass).text(t.currentGridColumnDef.displayName).appendTo(u);$("<div>").attr(c,"").appendTo(f);$("<div>").attr(l,"").appendTo(u);i.append(r(u)(t))}}}}}}}]).directive("trNgGridColumnSort",[function(){return{restrict:"A",replace:!0,templateUrl:n.columnSortTemplateId}}]).directive("trNgGridColumnFilter",[function(){return{restrict:"A",replace:!0,templateUrl:n.columnFilterTemplateId}}]).filter("paging",function(){return function(n,t){var i,r;return(n&&(t.totalItems=n.length),!t.pageItems||!n||n.length==0)?n:(t.currentPage||(t.currentPage=0),i=t.currentPage*t.pageItems,i>=n.length&&(t.currentPage=0,i=0),r=t.currentPage*t.pageItems+t.pageItems,n.slice(i,r))}}).directive("trNgGridBody",["$compile",function(f){return{restrict:"A",scope:!0,require:"^"+t,replace:!0,compile:function(t){var e=t.children("tr");return t.contents().remove(),{post:function(t,o,s,h){var l,c;t.gridOptions=h.gridOptions;t.toggleItemSelection=function(n){return h.toggleItemSelection(n)};l="gridItem in gridOptions.items";t.gridOptions.onDataRequired||(l+=" | filter:gridOptions.filterBy | filter:gridOptions.filterByFields | orderBy:gridOptions.orderBy:gridOptions.orderByReverse | paging:gridOptions");c=e.clone(!0);c.attr("ng-repeat",l);c.attr("ng-click")||c.attr("ng-click","toggleItemSelection(gridItem)");c.attr("ng-class","{'"+n.selectedRowCssClass+"':gridOptions.selectedItems.indexOf(gridItem)>=0}");c.attr(u,"{{$index}}");angular.forEach(t.gridOptions.gridColumnDefs,function(t,i){var r=c.children("td:nth-child("+(i+1)+")"),s=r.attr("field-name"),o=!1,e,u,f;s!==t.fieldName?(o=!0,e=$("<td>"),r.length==0?c.append(e):r.before(e),r=e):o=r.text()=="";o&&(u=$("<div>").addClass(n.cellCssClass),t.fieldName?(u.attr("field-name",t.fieldName),f="{{gridItem."+t.fieldName,t.displayFormat&&(t.displayFormat[0]!="|"&&t.displayFormat[0]!="."&&(f+=" | "),f+=t.displayFormat),f+="}}",u.text(f)):u.text("Invalid column match inside the table body"),r.append(u));t.displayAlign&&r.addClass("text-"+t.displayAlign);t.cellWidth&&r.css("width",t.cellWidth);t.cellHeight&&r.css("height",t.cellHeight)});o.append(f(c)(t));o.removeAttr(r);o.children("td["+i+"]").removeAttr(i)}}}}}]).directive("trNgGridFooter",[function(){return{restrict:"A",scope:!1,require:"^"+t,replace:!0,template:'<div class="'+n.footerOpsContainerCssClass+'"><span '+s+'=""/><span '+h+'=""/><\/div>'}}]).directive("trNgGridGlobalFilter",[function(){return{restrict:"A",replace:!0,scope:!0,require:"^"+t,template:function(){return'<span ng-show="gridOptions.enableFiltering" class="pull-left form-group"><input class="form-control" type="text" ng-model="gridOptions.filterBy" placeholder="Search"/><\/span>'},compile:function(){return{pre:function(n,t,i,r){n.gridOptions=r.gridOptions},post:function(){}}}}}]).directive("trNgGridPager",[function(){var n=function(n,t){n.gridOptions=t.gridOptions;n.isPaged=!!n.gridOptions.pageItems;n.totalItemsCount=typeof n.gridOptions.totalItems!="undefined"&&n.gridOptions.totalItems!=null?n.gridOptions.totalItems:n.gridOptions.items?n.gridOptions.items.length:0;n.startItemIndex=n.isPaged?n.gridOptions.pageItems*n.gridOptions.currentPage:0;n.endItemIndex=n.isPaged?n.startItemIndex+n.gridOptions.pageItems-1:n.totalItemsCount-1;n.endItemIndex>=n.totalItemsCount&&(n.endItemIndex=n.totalItemsCount-1);n.endItemIndex<n.startItemIndex&&(n.endItemIndex=n.startItemIndex);n.lastPageIndex=!n.totalItemsCount||!n.isPaged?0:Math.floor(n.totalItemsCount/n.gridOptions.pageItems)+(n.totalItemsCount%n.gridOptions.pageItems?0:-1);n.pageIndexes=[];for(var i=0;i<=n.lastPageIndex;i++)n.pageIndexes.push(i);n.pageSelectionActive=n.pageIndexes.length>1;n.pageCanGoBack=n.isPaged&&n.gridOptions.currentPage>0;n.pageCanGoForward=n.isPaged&&n.gridOptions.currentPage<n.lastPageIndex;n.navigateToPage=function(t,i){n.gridOptions.currentPage=i;t.preventDefault();t.stopPropagation()};n.switchPageSelection=function(t,i){n.pageSelectionActive=i;t&&(t.preventDefault(),t.stopPropagation())}};return{restrict:"A",scope:!0,require:"^"+t,template:function(){return'<span class="pull-right form-group"><ul class="pagination"><li ng-show="pageCanGoBack" ><a href="#" ng-click="navigateToPage($event, 0)" title="First Page">|&lArr;<\/a><\/li><li ng-show="pageCanGoBack" ><a href="#" ng-click="navigateToPage($event, gridOptions.currentPage - 1)" title="Previous Page">&lArr;<\/a><\/li><li ng-show="pageSelectionActive" style="white-space: nowrap;"><span>Page: <select ng-model="gridOptions.currentPage" ng-options="pageIndex as (pageIndex+1) for pageIndex in pageIndexes"><\/select><\/span><\/li><li class="disabled" style="white-space: nowrap;"><span ng-hide="totalItemsCount">No items to display<\/span><span ng-show="totalItemsCount" title="Select Page">  {{startItemIndex+1}} - {{endItemIndex+1}} displayed<span>, {{totalItemsCount}} in total<\/span><\/span > <\/li><li ng-show="pageCanGoForward"><a href="#" ng-click="navigateToPage($event, gridOptions.currentPage + 1)" title="Next Page">&rArr;<\/a><\/li><li><li ng-show="pageCanGoForward"><a href="#" ng-show="pageCanGoForward" ng-click="navigateToPage($event, lastPageIndex)" title="Last Page">&rArr;|<\/a><\/li><\/ul><\/span>'},replace:!0,link:{pre:function(t,i,r,u){n(t,u)},post:function(t,i,r,u){t.$watchCollection("[gridOptions.currentPage, gridOptions.items.length, gridOptions.totalItems, gridOptions.pageItems]",function(){n(t,u)})}}}}]).run(["$templateCache",function(t){t.put(n.columnFilterTemplateId,"<div ng-show='currentGridColumnDef.enableFiltering' class='"+n.filterColumnCssClass+"'><div class='"+n.filterInputWrapperCssClass+"'><input class='form-control input-sm' type='text' ng-model='filter'/><\/div><\/div>");t.put(n.columnSortTemplateId,"<div ng-show='currentGridColumnDef.enableSorting' ng-click='toggleSorting(currentGridColumnDef.fieldName)' title='Sort' class='"+n.sortCssClass+"'><div ng-class=\"{'"+n.sortActiveCssClass+"':gridOptions.orderBy==currentGridColumnDef.fieldName,'"+n.sortInactiveCssClass+"':gridOptions.orderBy!=currentGridColumnDef.fieldName,'"+n.sortNormalOrderCssClass+"':gridOptions.orderBy!=currentGridColumnDef.fieldName||!gridOptions.orderByReverse,'"+n.sortReverseOrderCssClass+"':gridOptions.orderBy==currentGridColumnDef.fieldName&&gridOptions.orderByReverse}\"  ><\/div><\/div>")}])})(TrNgGrid||(TrNgGrid={}));
/*
//# sourceMappingURL=trNgGrid.min.js.map
*/